/* =============================================================================
   app.css — SINGLE FILE (tokens + base + components + CI end section)
   -----------------------------------------------------------------------------
   Ziele
   - Lesbarkeit zuerst (neutraler heller Default; Gelb nur als Accent)
   - Einmalige Definitionen (keine doppelten #app/.panel/.tip usw.)
   - "Quick knobs" über CSS Custom Properties
   - Bootstrap wird NICHT kaputt-overridden (nur gezielte Tuning-Regeln)
   ============================================================================= */


/* =============================================================================
   0) DESIGN TOKENS (Default Theme)
   - Das ist dein “produktiver” Default: modern, hell, sehr gut lesbar.
   - CI kommt GANZ AM ENDE als Override-Section.
   ============================================================================= */

:root {
  /* --- Brand / Accents ---------------------------------------------------- */
  --brand-primary: #2563eb;          /* blue */
  --brand-accent:  #fbbf24;          /* amber (dein gelb) */
  --brand-accent-50: #fff7e0;


    /* required for rgba() overlay */
  --brand-accent-rgb: 245, 196, 0;

  /* tweak overlay strength centrally */
  --legend-overlay-alpha: 0.85;


  /* --- Text & Surfaces ---------------------------------------------------- */
  --muted: rgba(17, 24, 39, 0.74);        /* readable muted text */
  --bg: var(--muted);                     /* page background */

  /* Surfaces are expressed as RGB + alpha so we can switch between solid and glass */
  --surface-rgb: 255, 255, 255;           /* base surface color */
  --surface-alpha: 0.00;                  /* cards / panels (transparent as requested) */
  --surface-2-alpha: 0.06;                /* subtle contrast (glass buttons etc.) */

  --surface: rgba(var(--surface-rgb), var(--surface-alpha));
  --surface-2: rgba(var(--surface-rgb), var(--surface-2-alpha));

  --text: #111827;                        /* near-black (strong readability) */

  /* --- Dropdown (open menus) ------------------------------------------------ */
  --dropdown-menu-fg: #ffffff;           /* requested: white text in opened selects */


  /* Bridge (für Code, der --fg verwendet) */
  --fg: var(--text);
  --fg-muted: var(--muted);

  /* --- Borders + Shadows -------------------------------------------------- */
  --hairline: rgba(11, 18, 32, 0.10);
  --hairline-2: rgba(11, 18, 32, 0.14);
  --shadow-sm: 0 6px 18px rgba(11, 18, 32, 0.08);
  --shadow-md: 0 14px 40px rgba(11, 18, 32, 0.12);

  /* --- Focus ring --------------------------------------------------------- */
  --ring: rgba(37, 99, 235, 0.35);   /* default focus (primary) */

  /* --- Radii -------------------------------------------------------------- */
  --radius: 16px;
  --radius-sm: 10px;

  /* --- Spacing ------------------------------------------------------------ */
  --panel-pad: 18px;
  --panel-radius: var(--radius);

  /* --- Typography --------------------------------------------------------- */
  --font-ui: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  --font-body: "Work Sans", var(--font-ui);
  --font-heading: "Quicksand", var(--font-ui);

  /* Responsive font scale */
  --fs-0: clamp(0.875rem, 0.84rem + 0.20vw, 0.95rem); /* small */
  --fs-1: clamp(0.98rem, 0.92rem + 0.35vw, 1.08rem);  /* body */
  --fs-2: clamp(1.10rem, 1.02rem + 0.50vw, 1.22rem);  /* emphasis */
  --fs-3: clamp(1.25rem, 1.10rem + 0.90vw, 1.65rem);  /* headings */

  --line-normal: 1.55;

  /* --- Controls ----------------------------------------------------------- */
  --control-font: var(--fs-1);
  --control-pad-y: 0.55rem;
  --control-pad-x: 0.75rem;
  --control-radius: 0.75rem;
  --control-bg: var(--surface);
  --control-fg: var(--text);
  --control-border: rgba(11, 18, 32, 0.18);
  --control-border-hover: rgba(11, 18, 32, 0.28);
  --control-focus-ring: 0 0 0 0.20rem var(--ring);

  /* --- Tooltip ------------------------------------------------------------ */
  --tip-bg: #0b1220;                 /* dark card for strong contrast */
  --tip-text: #ffffff;
  --tip-border: rgba(255, 255, 255, 0.16);
  --tip-radius: 0.85rem;
  --tip-pad-y: 0.55rem;
  --tip-pad-x: 0.65rem;
  --tip-font: var(--fs-0);
  --tip-maxw: 440px;
  --tip-shadow: var(--shadow-md);

  /* --- Legend ------------------------------------------------------------- */
  --legend-dot-border: rgba(11, 18, 32, 0.18);
  --legend-disabled-opacity: 0.35;

  /* --- Chart sizing ------------------------------------------------------- */
  --chart-min-h: 520px;
}


/* =============================================================================
   1) TYPOGRAPHY (Local webfonts)
   - KEIN "/public" Prefix (typische 404-Quelle).
   ============================================================================= */

@font-face { /* Quicksand-300 */
  font-family: "Quicksand";
  src: url("/assets/fonts/quicksand/quicksand-300-normal.woff2") format("woff2");
  font-weight: 300;
  font-style: normal;
  font-display: swap;
}

@font-face { /* Quicksand-700 */
  font-family: "Quicksand";
  src: url("/assets/fonts/quicksand/quicksand-700-normal.woff2") format("woff2");
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

@font-face { /* Work Sans-100 */
  font-family: "Work Sans";
  src: url("/assets/fonts/work-sans/work-sans-100-normal.woff2") format("woff2");
  font-weight: 100;
  font-style: normal;
  font-display: swap;
}

@font-face { /* Work Sans-100 italic */
  font-family: "Work Sans";
  src: url("/assets/fonts/work-sans/work-sans-100-italic.woff2") format("woff2");
  font-weight: 100;
  font-style: italic;
  font-display: swap;
}


/* =============================================================================
   2) BASE (global, framework-agnostic)
   ============================================================================= */

html { color-scheme: light; }

html,
body {
  min-height: 100svh;
  margin: 0;

  color: var(--text);
  background: var(--bg);
   background: var(--brand-accent-50);

  font-family: var(--font-body);
  font-weight: 400;
  font-size: var(--fs-1);
  line-height: var(--line-normal);

  text-rendering: geometricPrecision;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Links */
a { color: var(--brand-primary); text-decoration: none; }
a:hover { text-decoration: underline; }

/* Focus: unified, accessible */
:where(a, button, input, select, textarea, [tabindex]):focus-visible {
  outline: 3px solid var(--ring);
  outline-offset: 2px;
  border-radius: 10px;
}

/* A11y helper */
.srOnly {
  position: absolute !important;
  width: 1px; height: 1px;
  padding: 0; margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}


/* =============================================================================
   3) APP ROOT
   - Kein Gelb als Dauer-Hintergrund; nur subtiler Accent via Gradients.
   ============================================================================= */

#app {
  min-height: 100svh;
  height: 100%;
  box-sizing: border-box;
  padding: var(--panel-pad);

  background:
    radial-gradient(900px 500px at 15% 0%, rgba(37, 99, 235, 0.10), transparent 60%),
    radial-gradient(900px 500px at 85% 10%, rgba(251, 191, 36, 0.10), transparent 55%),
    var(--bg);
}


/* =============================================================================
   4) PANEL / LAYOUT
   ============================================================================= */

.panel {
  height: 100%;
  width: 100%;
  box-sizing: border-box;

  padding: var(--panel-pad) var(--panel-pad) 14px;
  border-radius: var(--panel-radius);

  background: var(--surface);
  border: 1px solid var(--hairline);
  box-shadow: var(--shadow-sm);
  backdrop-filter: blur(8px);

  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* KPI header utilities (nicht Bootstrap `.row` überschreiben!) */
.kpi-row {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 12px;
}

.kpi-rowRight {
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap;
}


/* =============================================================================
   5) TYPO (optional classes)
   ============================================================================= */

.title {
  font-family: var(--font-heading);
  font-weight: 750;
  font-size: var(--fs-3);
  line-height: 1.15;
  letter-spacing: -0.01em;
  margin: 0;
  color: var(--text);
}


/*
.subtitle {
  margin: 6px 0 0;
  color: var(--brand-accent);
  font-weight: 600;
}
  */


/* =============================================================================
   6) CONTROLS
   - `.select` falls du custom nutzt; Bootstrap selects werden unten getuned.
   ============================================================================= */

.select {
  font-size: var(--control-font);
  padding: var(--control-pad-y) var(--control-pad-x);
  border-radius: var(--control-radius);
  border: 1px solid var(--control-border);
  background: var(--control-bg);
  color: var(--control-fg);
}

.select:hover {
  border-color: var(--control-border-hover);
}

.select:focus-visible {
  outline: none;
  box-shadow: var(--control-focus-ring);
}

/* Optional: custom dropdown panel (falls genutzt) */
.dropdown-panel {
  position: absolute;
  z-index: 50;
  width: 100%;
  max-height: 320px;
  overflow: auto;

  /* Readability: enforce high-contrast text inside the panel */
  color: var(--text);
  background: var(--surface);
  border: 1px solid var(--hairline);
  border-radius: var(--radius-sm);

  padding: 12px;
  box-shadow: var(--shadow-md);
}

/* Make sure all text inside stays readable (no accidental low-opacity styles) */
.dropdown-panel * {
  color: inherit;
  opacity: 1;
}

.hidden { display: none; }

.src-list label {
  display: flex;
  gap: 10px;
  padding: 8px 6px;
  align-items: center;
  cursor: pointer;

  /* Readability */
  color: var(--text);
  font-weight: 500;
}

/* Dropdown header / trigger (if your custom select uses `.select`) */
.select {
  color: var(--text);
  font-weight: 500;
}

/* "Alle" / "Reset" buttons inside dropdown panel */
.dropdown-panel button,
.dropdown-panel .btn {
  color: var(--text);
  font-weight: 600;
  background: var(--surface-2);
  border: 1px solid var(--hairline-2);
}

.dropdown-panel button:hover,
.dropdown-panel .btn:hover {
  border-color: rgba(17, 24, 39, 0.28);
}


/* =============================================================================
   7) LEGEND
   ============================================================================= */

.legend__dot {
  width: 10px;
  height: 10px;
  border-radius: 999px;
  flex: 0 0 10px;
  box-shadow: 0 0 0 1px var(--legend-dot-border);
}

.legend__label { opacity: 0.95; }

.legend__item.is-disabled .legend__dot,
.legend__item.is-disabled .legend__label {
  opacity: var(--legend-disabled-opacity);
}


/* =============================================================================
   8) CHART
   - Weißes Chart-Feld, klare Card, kein Durchscheinen (bessere Lesbarkeit)
   ============================================================================= */

.chartWrap {
  flex: 1 1 auto;
  position: relative;

  background: transparent;
  border: 1px solid var(--hairline-2);
  border-radius: var(--radius);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
}

.chartWrap svg {
  width: 100%;
  height: 100%;
  min-height: var(--chart-min-h);
  display: block;
  background: transparent;
}

/* Pragmatic sizing hooks (falls dein Markup IDs nutzt) */
#chartWrap,
#chartSvg { width: 100%; }

#chartSvg {
  display: block;
  height: var(--chart-min-h); /* JS kann viewBox nutzen; CSS sorgt für Sichtbarkeit */
}




/* =============================================================================
   10) YEAR RANGE SUMMARY (text must stay readable)
   ============================================================================= */

.yearRange__summary {
  font-size: clamp(0.98rem, 0.92rem + 0.25vw, 1.12rem);
  line-height: 1.35;
  font-weight: 700;
  color: var(--text);
  color: var(--brand-accent);
  letter-spacing: 0.02em;
  text-align: center;
  user-select: none;

  transform: none; /* safety if wrappers scale */
}

.yearRange__summary::before {
  content: "";
  display: block;
  width: 3rem;
  height: 1px;
  margin: 0.25rem auto 0.35rem;
  background: currentColor;
  opacity: 0.25;
}


/* =============================================================================
   11) D3 / SVG labels (deliberately small)
   ============================================================================= */

.cat-label { font-size: 10px; fill: #334155; } /* slate-700 */
.type-label { font-size: 9px; fill: #475569; pointer-events: none; } /* slate-600 */


/* =============================================================================
   12) UTILITIES
   ============================================================================= */

.net-inline--pos { color: var(--net-pos); }
.net-inline--neg { color: var(--net-neg); }

.muted { color: var(--muted); }


/* =============================================================================
   13) BOOTSTRAP TUNING (gezielt, “safe”)
   ============================================================================= */

/* Bootstrap columns need this when children overflow or have fixed widths */
.row > [class*="col-"] { min-width: 0; }

/* Form selects: modern, readable, not-yellow-by-default */
select.form-select {
  background-color: transparent;
  border: 1px solid var(--hairline);
  border-radius: var(--radius-sm);
  box-shadow: none;
  color: var(--text);
  font-weight: 500;
  opacity: 1;
}

select.form-select:hover {
  border-color: rgba(11, 18, 32, 0.22);
}

select.form-select:focus {
  border-color: var(--brand-primary);
  box-shadow: var(--control-focus-ring);
}

/* Dropdown menus (Bootstrap) -> width zuverlässig */
.dropdown-menu.w-100 { min-width: 100%; }

/* Buttons: keep Bootstrap behavior, only tune shape */
.btn,
button { font: inherit; border-radius: 0.85rem; }

.btn:focus-visible { box-shadow: var(--control-focus-ring); }

/* =============================================================================
   13.1) READABILITY BOOST (Insights  + Filter triggers)
   - Keep changes scoped and minimal.
   - IMPORTANT: Category Inspector table styling is intentionally untouched.
   ============================================================================= */

/* Insights cards: kill washed-out grey and make content scanable */
#insights .card-title,
#insights .card-body,
#insights .insights__body,
#insights .card-text,
#insights p {
  color: var(--text) !important;
  opacity: 1 !important;
  -webkit-text-fill-color: var(--text) !important;
}

#insights .card-title {
  font-weight: 800;
}


/* Filter dropdown trigger buttons (collapsed state): CI yellow, readable text */
.dropdown:not(.show) .btn.btn-outline-secondary.dropdown-toggle,
.dropdown:not(.show) .btn.btn-outline-secondary {
  background: var(--brand-accent) !important;
  border-color: rgba(17, 24, 39, 0.26) !important;
  color: var(--text) !important;
}

/* When open: keep trigger neutral so the menu reads clean */
.dropdown.show .btn.btn-outline-secondary.dropdown-toggle,
.dropdown.show .btn.btn-outline-secondary {
  background: transparent !important;
  color: var(--text) !important;
}


/* =============================================================================
   BOOTSTRAP MULTI-SELECT DROPDOWNS — FORCE READABILITY (BLACK)
   Works for: #srcBtn/#typeBtn/#catBtn + .dropdown-menu + label.dropdown-item
   ============================================================================= */

/* Trigger button (Typen: alle / Kategorien: alle / Quellen: alle) */
.dropdown .btn.btn-outline-secondary.dropdown-toggle,
.dropdown .btn.btn-outline-secondary {
  color: var(--text) !important;
  opacity: 1 !important;
  font-weight: 600 !important;
  background: transparent !important;
  border-color: rgba(17, 24, 39, 0.26) !important;
}

.dropdown .btn.btn-outline-secondary:hover {
  border-color: rgba(17, 24, 39, 0.40) !important;
}

.dropdown .btn.btn-outline-secondary:focus,
.dropdown .btn.btn-outline-secondary:focus-visible {
  box-shadow: var(--control-focus-ring) !important;
}

/* Menu surface */
.dropdown-menu {
  /* When the menu is open, we want white labels */
  color: var(--dropdown-menu-fg) !important;

  background: transparent !important;
  border: 1px solid var(--hairline-2) !important;
  border-radius: var(--radius) !important;
  box-shadow: var(--shadow-md) !important;
  opacity: 1 !important;
}

/* ---------------------------------------------------------------------------
   TRANSPARENT SURFACES (Bootstrap containers)
   - These often draw white backgrounds independent of `.panel`.
   - Making them transparent reveals the app background image/gradient.
--------------------------------------------------------------------------- */
.card,
.card-body,
.card-header,
.card-footer {
  background: transparent !important;
}

.accordion-item,
.accordion-body {
  background: transparent !important;
}


.dropdown-menu .dropdown-item {
  color: var(--dropdown-menu-fg) !important;
  -webkit-text-fill-color: var(--dropdown-menu-fg) !important; /* critical: overrides iOS/Safari paint */

  opacity: 1 !important;
  font-weight: 500 !important;
}

.dropdown-menu .dropdown-item:hover,
.dropdown-menu .dropdown-item:focus {
  background: rgba(37, 99, 235, 0.08) !important;
}

/* Checkbox visibility */
.dropdown-menu .form-check-input {
  opacity: 1 !important;
}

/* "Alle" / "Reset" buttons inside menu */
.dropdown-menu .btn.btn-sm.btn-outline-secondary {
  color: var(--text) !important;
  opacity: 1 !important;
  font-weight: 600 !important;
  background: var(--surface-2) !important;
  border-color: rgba(17, 24, 39, 0.22) !important;
}

.dropdown-menu .btn.btn-sm.btn-outline-secondary:hover {
  border-color: rgba(17, 24, 39, 0.36) !important;
}




/* =============================================================================
   HARD OVERRIDE: Multi-Select option labels MUST be solid (menu fg token)
   Targets your actual markup: #srcList/#typeList/#catList > label.dropdown-item
   ============================================================================= */

#srcList label.dropdown-item,
#typeList label.dropdown-item,
#catList  label.dropdown-item {
  /* Single source of truth for option label color */
  color: var(--dropdown-menu-fg) !important;
  -webkit-text-fill-color: var(--dropdown-menu-fg) !important; /* THIS was forcing #111 before */

  opacity: 1 !important;
  font-weight: 650 !important;

  /* Kill “outlined / washed out” rendering */
  -webkit-text-stroke: 0 transparent !important;
  text-shadow: none !important;
  filter: none !important;
}

/* Ensure nothing inside the label can re-mute it */
#srcList label.dropdown-item *,
#typeList label.dropdown-item *,
#catList  label.dropdown-item * {
  color: inherit !important;
  opacity: 1 !important;
  -webkit-text-fill-color: var(--dropdown-menu-fg) !important;
  filter: none !important;
}


/* =============================================================================
   LEGEND PANEL (refactor)
   Goals:
   - legend stays a true square, fully visible on wide screens
   - size square primarily by available HEIGHT (not width)
   - allow background image + brand accent overlay without touching SVG logic
   ============================================================================= */

/* --- base: always safe, independent from breakpoint ------------------------ */

aside[aria-label="Legende"] .panel {
  position: relative;
  min-height: 0; /* important for nested flex containers */
}

/* Legend root becomes stacking context for bg + svg */
aside[aria-label="Legende"] #legend.legend {
  position: relative;
  min-height: 0;
}

/* Background layer: image + overlay tint */
aside[aria-label="Legende"] #legend.legend::before {
  content: "";
  position: absolute;
  inset: 0;

  
  z-index: 0;
  pointer-events: none; /* never block drag/hover in legend */
}

/* Legend SVG always above background */
aside[aria-label="Legende"] #legend .legend-graph {
  position: relative;
  z-index: 1;
  display: block;
}

/* Safety: internal layers track SVG viewport */
#legend .legend-graph__edges,
#legend .legend-graph__nodes {
  width: 100%;
  height: 100%;
}

/* --- lg+ layout: two columns ------------------------------------------------ */

@media (min-width: 992px) {
  /* Right panel should distribute height */
  aside[aria-label="Legende"] .panel {
    display: flex;
    flex-direction: column;
    min-height: 0;
  }

  /* Legend wrapper consumes remaining panel height */
  aside[aria-label="Legende"] #legend.legend {
    flex: 1 1 auto;
    min-height: 0;

    /* center the square viewport inside available space */
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Square-by-height: fit within both height and width */
  aside[aria-label="Legende"] #legend .legend-graph {
    height: 100%;
    width: auto;
    aspect-ratio: 1 / 1;

    /* keep it inside the column */
    max-width: 100%;
    max-height: 100%;

    /* if there is spare width, keep it centered */
    margin: 0 auto;
  }
}



.category-inspector__tableWrap {
  max-height: 320px;
  overflow: auto;
}

.category-inspector__title {
  font-weight: 600;
  margin-bottom: 0.5rem;
}

.inspector__empty {
  opacity: 0.6;
  font-style: italic;
}




/* ---------------------------------------------------------------------------
   Category Inspector – IBM/AS400 style (scoped)
--------------------------------------------------------------------------- */

.category-inspector {
  background: #061006;              /* dark green/black */
  color: #74ff74;                   /* phosphor green */
  border: 1px solid rgba(116, 255, 116, 0.35);
  border-radius: 0;                 /* AS/400: kantig */
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
               "Liberation Mono", "Courier New", monospace;
  font-size: 13px;
  line-height: 1.25;
}

.category-inspector__tableWrap {
  max-height: 360px;                /* falls du mehr willst: erhöhen */
  overflow: auto;
}

/* Bootstrap table reset inside inspector */
.category-inspector table.table {
  color: inherit;
  margin: 0;
}

.category-inspector table.table > :not(caption) > * > * {
  background: transparent !important;   /* kill bootstrap row bg */
}

/* grid + padding */
.category-inspector th,
.category-inspector td {
  padding: 4px 8px !important;
  border-bottom: 1px solid rgba(116, 255, 116, 0.18) !important;
  white-space: nowrap;                  /* typisch terminal; bei Bedarf auf normal stellen */
}

/* header: sticky */
.category-inspector thead th {
  position: sticky;
  top: 0;
  z-index: 2;
  background: #031003 !important;
  color: #b7ffb7;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  border-bottom: 1px solid rgba(116, 255, 116, 0.35) !important;
}

/* zebra + hover */
.category-inspector tbody tr:nth-child(even) td {
  background: rgba(116, 255, 116, 0.04) !important;
}

.category-inspector tbody tr:hover td {
  background: rgba(116, 255, 116, 0.10) !important;
}

/* empty state */
.inspector__empty {
  padding: 10px 12px;
  background: #061006;
  color: rgba(116, 255, 116, 0.85);
  border: 1px solid rgba(116, 255, 116, 0.25);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
               "Liberation Mono", "Courier New", monospace;
}




/* ---------------------------------------------------------------------------
   Category Inspector – CI text color override
--------------------------------------------------------------------------- */

/* Default Text (Datensätze) */
.category-inspector,
.category-inspector td,
.category-inspector tbody td {
  color: var(--brand-accent) !important;
}

/* Header etwas heller / kontrastreicher */
.category-inspector thead th {
  color: #ffffff !important;
}